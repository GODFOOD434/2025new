# Excel导入处理流程

## 1. 导入流程

1. 用户从ERP下载采购订单Excel文件
2. 用户登录系统，进入"采购订单导入"页面
3. 上传Excel文件
4. 系统解析Excel文件，提取以下字段：
   - 采购订单号
   - 行项目号
   - 计划编号
   - 用户单位
   - 大类
   - 订单生成日期
   - 供应商名称
   - 物料组
   - 物资编码
   - 物资描述
   - 计量单位
   - 申请数量
   - 签约单价
   - 产品标准
   - 签约金额
   - 长描述
   - 价格标志
   - 工厂
   - 采购订单数
   - 一级目录产品
   - 供应商代码
5. 系统自动过滤掉"序号"列
6. 系统验证数据有效性
7. 将数据保存到数据库
8. 返回导入结果

## 2. 数据验证规则

- 采购订单号不能为空
- 行项目号不能为空
- 物资编码不能为空
- 申请数量必须大于0
- 签约单价必须大于等于0
- 检查是否有重复的采购订单号+行项目号组合

## 3. 错误处理

- 对于验证失败的记录，生成错误报告
- 允许用户下载错误报告
- 支持部分导入（有效记录导入，无效记录跳过）

## 4. 导入后处理

- 记录导入日志
- 发送导入完成通知
- 更新系统缓存
- 触发相关业务流程（如有）
